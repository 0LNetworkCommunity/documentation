"use strict";(self.webpackChunkopen_libra_core_docs=self.webpackChunkopen_libra_core_docs||[]).push([[5072],{2764:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>c,contentTitle:()=>s,default:()=>h,frontMatter:()=>i,metadata:()=>l,toc:()=>a});var r=o(5893),t=o(1151);const i={},s="Move Formal Verification",l={id:"developers/core_devs/formal_verification",title:"Move Formal Verification",description:"The Move language includes a syntax for annotating code with spec",source:"@site/docs/developers/core_devs/formal_verification.md",sourceDirName:"developers/core_devs",slug:"/developers/core_devs/formal_verification",permalink:"/developers/core_devs/formal_verification",draft:!1,unlisted:!1,editUrl:"https://github.com/0LNetworkCommunity/documentation/edit/main/docs/developers/core_devs/formal_verification.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Libra Move Dev Quick Start",permalink:"/developers/core_devs/dev_quick_start"},next:{title:"Governance fixtures",permalink:"/developers/core_devs/governance_fixtures"}},c={},a=[{value:"Quick Start",id:"quick-start",level:2},{value:"Troubleshooting",id:"troubleshooting",level:2}];function d(e){const n={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",...(0,t.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h1,{id:"move-formal-verification",children:"Move Formal Verification"}),"\n",(0,r.jsxs)(n.p,{children:["The Move language includes a syntax for annotating code with ",(0,r.jsx)(n.code,{children:"spec"}),'\nspecifications which can be "formally verified". The syntax is purpose built for\nMove. The stack behind the verification is based on ',(0,r.jsx)(n.code,{children:"boogie"}),"."]}),"\n",(0,r.jsx)(n.p,{children:"You will need to install many dependencies for the Move test tooling as well as\nboogie system libraries."}),"\n",(0,r.jsx)(n.h2,{id:"quick-start",children:"Quick Start"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"get the libra cli with standard Move tools"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["Compile the ",(0,r.jsx)(n.code,{children:"libra"})," cli app, and have it in your executable PATH."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"cargo b --profile cli -p libra\ncp target/cli/libra ~/.cargo/bin\nchmod +x ~/.cargo/bin/libra\n\n# check it runs\nlibra -h\n# this is the subcommand for the formal verification\nlibra move prove -h\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"2",children:["\n",(0,r.jsx)(n.li,{children:"Install the Boogie dependencies"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"dev_setup.sh"})," can be run with these options:"]}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"-y install or update Move Prover tools: z3, cvc5, dotnet, boogie"}),"\n"]}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"-p update $HOME/.profile or ./bashrc"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"# run the installer\nbash util/dev_setup.sh -yp\n\n# you may need to restart your shell, after env variables are set\n# or .bashrc, or .zshrc\n\nbash ~/.profile\n\n"})}),"\n",(0,r.jsx)(n.p,{children:"Whatever terminal shell (or .zshrc) you are using you should check that these variable are exported:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'export DOTNET_ROOT="$HOME/.dotnet"\nexport Z3_EXE="$HOME/bin/z3"\nexport CVC5_EXE="$HOME/bin/cvc5"\nexport BOOGIE_EXE="$HOME/.dotnet/tools/boogie"\nexport SOLC_EXE="$HOME/bin/solc"\n'})}),"\n",(0,r.jsxs)(n.ol,{start:"3",children:["\n",(0,r.jsxs)(n.li,{children:["check it all works\nyou'll be running formal verification specs against ",(0,r.jsx)(n.code,{children:"libra-framework"})," move\nsource."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"So test it on something we know to work"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"cd framework/libra-framework\n\n# test the guid.move module\nlibra move prove -f guid\n"})}),"\n",(0,r.jsx)(n.p,{children:"If you get a response without errors similar to the message below you are ready to\nstart."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"[INFO] 0.903s build, 2.585s trafo, 0.019s gen, 1.313s verify, total 4.820s\n"})}),"\n",(0,r.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["check then env vars were set up ",(0,r.jsx)(n.code,{children:"echo $BOOGIE_EXE"})]}),"\n",(0,r.jsxs)(n.li,{children:["check that all the system libraries were installed ",(0,r.jsx)(n.code,{children:"ls $HOME/.dotnet/tools/boogie"})]}),"\n"]}),"\n",(0,r.jsx)(n.h1,{id:"goals",children:"Goals"}),"\n",(0,r.jsx)(n.p,{children:"Formal verification priority for Libra should mainly check that the network does\nnot halt in operations conducted by the VM."}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"epoch_boundary.move\nShould never halt on reconfigure()\nTHough there are many downstream modules and functions from here, the largest\nones being:"}),"\n",(0,r.jsx)(n.p,{children:"a. stake.move"}),"\n",(0,r.jsx)(n.p,{children:"b. proof_of_fee.move"}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"coin.move\na. Transactions by VM should not halt"}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"slow_wallet.move\na. no transactions should bypass the slow wallet tracker. If there is a slow\nwallet struct, a transaction should always alter it.\nb. no account, not even the VM can withdraw above the unlocked limit.\nc. the unlocked limit cannot be larger than the total."}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.a)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},1151:(e,n,o)=>{o.d(n,{Z:()=>l,a:()=>s});var r=o(7294);const t={},i=r.createContext(t);function s(e){const n=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:s(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);