<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-validators/hot-upgrades" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Network Hot Upgrades | Open Libra Documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://docs.openlibra.io/img/thumbnail.png"><meta data-rh="true" name="twitter:image" content="https://docs.openlibra.io/img/thumbnail.png"><meta data-rh="true" property="og:url" content="https://docs.openlibra.io/validators/hot-upgrades"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Network Hot Upgrades | Open Libra Documentation"><meta data-rh="true" name="description" content="Upgrading Framework Libraries"><meta data-rh="true" property="og:description" content="Upgrading Framework Libraries"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.openlibra.io/validators/hot-upgrades"><link data-rh="true" rel="alternate" href="https://docs.openlibra.io/validators/hot-upgrades" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.openlibra.io/validators/hot-upgrades" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://E8UE0IN6GG-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Open Libra Documentation RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Open Libra Documentation Atom Feed">




<link rel="search" type="application/opensearchdescription+xml" title="Open Libra Documentation" href="/opensearch.xml"><link rel="stylesheet" href="/assets/css/styles.974988ab.css">
<script src="/assets/js/runtime~main.868d9293.js" defer="defer"></script>
<script src="/assets/js/main.27f51de1.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="Open Libra Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.png" alt="Open Libra Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Open Libra Documentation</b></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/blog">Blog</a><a href="https://github.com/0LNetworkCommunity/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://discord.gg/0lnetwork" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://openlibra.io/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Website<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">Quick Start</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/category/programs">Programs</a><button aria-label="Expand sidebar category &#x27;Programs&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/category/core-devs">Core Devs</a><button aria-label="Expand sidebar category &#x27;Core Devs&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/category/tools">Tools</a><button aria-label="Expand sidebar category &#x27;Tools&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/category/validators">Validators</a><button aria-label="Collapse sidebar category &#x27;Validators&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/validators/getting-started">Getting Started</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/validators/sybil-resistance">0L Sybil Resistance</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/validators/validator-quickstart">Validator Quickstart</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/validators/detailed-instructions">Running a Validator</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/validators/register">Post-Genesis Ceremony Registration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/validators/vfn-setup">VFN</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/validators/governance-tx">Governance Transactions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/validators/with-docker-setup">Docker setup</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/validators/hot-upgrades">Hot Upgrades</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/category/yaml-templates">YAML Templates</a><button aria-label="Expand sidebar category &#x27;YAML Templates&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/validators/testnet">Start a Testnet</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/validators/rescue">Rescue Missions</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/category/archive">Archive</a><button aria-label="Expand sidebar category &#x27;Archive&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/category/write-docs">Write Docs</a><button aria-label="Expand sidebar category &#x27;Write Docs&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/category/validators"><span itemprop="name">Validators</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Hot Upgrades</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Network Hot Upgrades</h1></header>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="overview">Overview<a href="#overview" class="hash-link" aria-label="Direct link to Overview" title="Direct link to Overview">​</a></h2>
<p>The &quot;framework&quot; which contains all the consensus, account, econ policies, etc. for the network is written in Move. This code is stored in the network database and effectively executed on demand. This means that framework upgrades can occur without redeploying the Move VM itself or the supporting system code (network node software). It also means the state machine can upgrade without a coordinated halt.</p>
<ul>
<li>To do this, we require the <code>libra</code> CLI tool. The command <code>libra move framework</code> is used for building the artifacts, and <code>libra txs</code> for proposing, voting, and ultimately deploying the artifacts.</li>
<li>Metadata with the upgrade artifacts and proposal documentation can be found at: <a href="https://github.com/0LNetworkCommunity/upgrades" target="_blank" rel="noopener noreferrer">https://github.com/0LNetworkCommunity/upgrades</a></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="historical-upgrade-information-and-proposing-upgrades">Historical Upgrade Information and Proposing Upgrades<a href="#historical-upgrade-information-and-proposing-upgrades" class="hash-link" aria-label="Direct link to Historical Upgrade Information and Proposing Upgrades" title="Direct link to Historical Upgrade Information and Proposing Upgrades">​</a></h2>
<p>Historical upgrade information since release 7.0.0 is canonically stored in the <a href="https://github.com/0LNetworkCommunity/upgrades" target="_blank" rel="noopener noreferrer">upgrade repository</a>. To submit an upgrade proposal, you should draft a PR with the relevant information detailing the upgrade using the provided <a href="https://github.com/0LNetworkCommunity/upgrades/tree/main/proposals/template" target="_blank" rel="noopener noreferrer">template</a> and include the upgrade script packages.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="tldr">TL;DR<a href="#tldr" class="hash-link" aria-label="Direct link to TL;DR" title="Direct link to TL;DR">​</a></h2>
<ul>
<li><strong>Fetch the latest release</strong>:<!-- -->
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token builtin class-name">cd</span><span class="token plain"> libra-framework</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">git</span><span class="token plain"> fetch </span><span class="token parameter variable" style="color:#36acaa">--all</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">git</span><span class="token plain"> checkout release-x.x.x</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li><strong>Build framework</strong>:<!-- -->
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">libra move framework upgrade --output-dir </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">path/to</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">/framework_upgrade --framework-local-dir </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">path/to</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">/libra-framework/framework/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li><strong>Propose</strong>:<!-- -->
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">libra txs governance propose --proposal-script-dir </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">path/to</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">/framework_upgrade/1-move-stdlib/ --metadata-url https://github.com/0LNetworkCommunity/upgrades/tree/main/proposals/up-00</span><span class="token operator file-descriptor important" style="color:#393A34">0</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">PROPOSAL_ID</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">.md</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># NOTE: Do not repeat this step. Multistep (multiple modules) only need one proposal, and it should reference the first module, usually 1-move-stdlib</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li><strong>Each Validator votes</strong>:<!-- -->
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">libra txs governance vote --proposal-id </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">ID</span><span class="token operator" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li><strong>After vote, one person can resolve each module in order</strong>:<!-- -->
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">libra txs governance resolve --proposal-script-dir </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">path/to</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">/framework_upgrade/1-move-stdlib/ --proposal-id </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">ID</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">libra txs governance resolve --proposal-script-dir </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">path/to</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">/framework_upgrade/2-vendor-stdlib/ --proposal-id </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">ID</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">libra txs governance resolve --proposal-script-dir </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">path/to</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">/framework_upgrade/3-libra-framework/ --proposal-id </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">ID</span><span class="token operator" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="upgrade-types-single-and-multiple">Upgrade Types: Single and Multiple<a href="#upgrade-types-single-and-multiple" class="hash-link" aria-label="Direct link to Upgrade Types: Single and Multiple" title="Direct link to Upgrade Types: Single and Multiple">​</a></h2>
<p>When performing upgrades within the network framework, two primary approaches can be employed: single and multiple module upgrades. The key distinction lies in how these upgrades are proposed, voted on, and executed, particularly with respect to handling multiple modules.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="single-framework-upgrade">Single Framework Upgrade<a href="#single-framework-upgrade" class="hash-link" aria-label="Direct link to Single Framework Upgrade" title="Direct link to Single Framework Upgrade">​</a></h3>
<p>A single framework upgrade involves updating a singular set of modules within the framework. This process is straightforward and includes the following steps:</p>
<ul>
<li><strong>Build Framework</strong>: Generate the upgrade Move transaction scripts for the module.</li>
<li><strong>Proposal Submission</strong>: Propose the upgrade for the specific framework module.</li>
<li><strong>Validator Voting</strong>: Validators within the network vote for or against the proposed upgrade.</li>
<li><strong>Achieving Consensus</strong>: The proposal moves forward once it receives support from at least 66% of active validators.</li>
<li><strong>Resolution and Deployment</strong>: Resolve the proposal using the exact framework directory that matches the build of the proposed upgrade. This can be done by any validator using the same release branch from the <code>libra-framework</code> repository.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="multiple-framework-upgrades">Multiple Framework Upgrades<a href="#multiple-framework-upgrades" class="hash-link" aria-label="Direct link to Multiple Framework Upgrades" title="Direct link to Multiple Framework Upgrades">​</a></h3>
<p>Multiple framework upgrades require a more nuanced approach, especially regarding resolution stages, to ensure a coherent and secure update across several modules.</p>
<ul>
<li>
<p><strong>Build Framework</strong>: Similar to a single upgrade, start by generating Move transaction scripts for all relevant modules.</p>
</li>
<li>
<p><strong>Proposal for Initial Module</strong>: Propose the upgrade by using the first module (<code>1-move-stdlib</code>). This initial proposal is critical as it kickstarts the governance process for the entire upgrade.</p>
<p><em>WARN: Do not repeat proposals for subsequent modules, the three modules can be upgraded with a single instance.</em></p>
<p>Importantly, the transaction script for upgrading this first module includes a significant addition: <strong>the transaction hash for the subsequent modules</strong> that need upgrading. These hashes, produced during the artifact building phase, serve as secure identifiers for each module&#x27;s upgrade script. Do not run this step twice.</p>
</li>
<li>
<p><strong>Validator Voting</strong>: As with single upgrades, validators vote for or against the proposed upgrade.</p>
</li>
<li>
<p><strong>Achieving Consensus and Sequential Resolution</strong>: Once at least 66% of active validators support the proposal, the initial upgrade can be resolved.</p>
</li>
<li>
<p><strong>Sequential Upgrade Execution</strong>: Execute the resolution process for all involved modules, following the order 1-3.</p>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="upgrade-policy">Upgrade Policy<a href="#upgrade-policy" class="hash-link" aria-label="Direct link to Upgrade Policy" title="Direct link to Upgrade Policy">​</a></h2>
<p>The diem framework has information in the metadata that controls the policy that a publisher can set for upgrading their modules. These are:</p>
<ul>
<li>Arbitrary(0): Allows code upgrades without compatibility checks, for non-shared packages.</li>
<li>Compatible(1): Requires compatibility checks to ensure no breaking changes in public functions or resource layouts.</li>
<li>Immutable(2): Prevents any upgrades, ensuring the permanence of critical code.</li>
</ul>
<p>Due to some circumstances, a publisher may want to downgrade the policy to allow changes to go through that a restrictive policy would not allow. We can do this by building the framework with a flag (<code>--danger-force-upgrade</code>) that sets the upgrade policy as Arbitrary.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="example">Example<a href="#example" class="hash-link" aria-label="Direct link to Example" title="Direct link to Example">​</a></h4>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">libra txs governance propose --proposal-script-dir </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">path/to</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">/framework_upgrade/3-libra-framework/ --metadata-url https://github.com/0LNetworkCommunity/upgrades/tree/main/proposals/up-00</span><span class="token operator file-descriptor important" style="color:#393A34">0</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">PROPOSAL_ID</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> --danger-force-upgrade</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="procedure">Procedure<a href="#procedure" class="hash-link" aria-label="Direct link to Procedure" title="Direct link to Procedure">​</a></h2>
<p>We will use this guide to do a multi-step upgrade as this is the most common upgrade that is done.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="build-artifacts">Build Artifacts<a href="#build-artifacts" class="hash-link" aria-label="Direct link to Build Artifacts" title="Direct link to Build Artifacts">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="1-build-the-upgrade-move-transaction-scripts">1. Build the upgrade Move transaction scripts<a href="#1-build-the-upgrade-move-transaction-scripts" class="hash-link" aria-label="Direct link to 1. Build the upgrade Move transaction scripts" title="Direct link to 1. Build the upgrade Move transaction scripts">​</a></h4>
<p>This will be a Move package which is machine-generated for a one-time execution. It contains bytecode which will be allowed to be executed (by anyone), once there is a vote and agreement on the proposal passing. The on-chain execution is guarded with a hash of this transaction, which the proposer provides in the proposal transaction (in advance of the vote).</p>
<p>An upgrade script that is tampered with will yield a different execution hash and will be prevented from running (it is likely to be blocked by the transaction size limits before entering the mempool).</p>
<p>The <code>libra-framework upgrade</code> command will produce a newly compiled Move upgrade transaction script, its binary, and the hash.</p>
<p>You need to provide:</p>
<ul>
<li><code>--output-dir</code>: this directory the upgrade transaction files should be saved to. A new folder called <code>framework_upgrade</code> will be created under the output-dir path.</li>
<li><code>--framework-local-dir</code>: the source code for the framework so that the transaction script can import it as a dependency.</li>
</ul>
<p>Optionally you could provide the flag <code>--danger-force-upgrade</code>.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="multi-or-single-upgrade">Multi or Single Upgrade<a href="#multi-or-single-upgrade" class="hash-link" aria-label="Direct link to Multi or Single Upgrade" title="Direct link to Multi or Single Upgrade">​</a></h4>
<p>Know the difference between a single step and multi-step upgrades.
An upgrade that changes all three (stdlib, vendor-stdlib, libra-framework) looks like this:
<a href="https://github.com/0LNetworkCommunity/upgrades/blob/main/proposals/up-0004/" target="_blank" rel="noopener noreferrer">https://github.com/0LNetworkCommunity/upgrades/blob/main/proposals/up-0004/</a></p>
<p>An upgrade that changes only one module <code>libra-framework</code> can be seen here:
<a href="https://github.com/0LNetworkCommunity/upgrades/tree/main/proposals/up-0009" target="_blank" rel="noopener noreferrer">https://github.com/0LNetworkCommunity/upgrades/tree/main/proposals/up-0009</a></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="default-produce-all-three-module-upgrades">Default: Produce all three module upgrades<a href="#default-produce-all-three-module-upgrades" class="hash-link" aria-label="Direct link to Default: Produce all three module upgrades" title="Direct link to Default: Produce all three module upgrades">​</a></h3>
<p>Includes: stdlib, vendor-stdlib, libra-framework.</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Note the paths</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">libra-framework upgrade </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--output-dir </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">OUTPUT_DIR</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--framework-local-dir </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">FRAMEWORK_PATH</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Example</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">libra-framework upgrade </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--output-dir </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">path/to</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">/framework_upgrade </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--framework-local-dir </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">path/to</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">/libra-framework/framework/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="note-this-creates-3-separate-library-upgrade-script-directories">NOTE: This creates 3 separate library upgrade script directories<a href="#note-this-creates-3-separate-library-upgrade-script-directories" class="hash-link" aria-label="Direct link to NOTE: This creates 3 separate library upgrade script directories" title="Direct link to NOTE: This creates 3 separate library upgrade script directories">​</a></h4>
<ul>
<li>1-move-stdlib</li>
<li>2-vendor-stdlib</li>
<li>3-libra-framework</li>
</ul>
<p>All the artifacts are now created, the proposal transaction can be submitted. But it&#x27;s a good idea to document this on GitHub first.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="light-only-update-one-of-the-modules">Light: Only update one of the modules<a href="#light-only-update-one-of-the-modules" class="hash-link" aria-label="Direct link to Light: Only update one of the modules" title="Direct link to Light: Only update one of the modules">​</a></h3>
<p>If the code is backwards compatible, you can update a single module. This can be true for <code>libra-framework</code>, when there are no changes to <code>stdlib</code> or <code>vendor-stdlib</code>.</p>
<p>In that case, you can include the argument <code>--core-modules libra-framework</code>.</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># example:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">libra-framework upgrade --core-modules libra-framework </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--output-dir </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">path/to</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">/framework_upgrade </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--framework-local-dir </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">path/to</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">/libra-framework/framework/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Note: --danger-force-upgrade can also be used here</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="2-share-the-output-artifacts-on-github">2. Share the output artifacts on GitHub.<a href="#2-share-the-output-artifacts-on-github" class="hash-link" aria-label="Direct link to 2. Share the output artifacts on GitHub." title="Direct link to 2. Share the output artifacts on GitHub.">​</a></h4>
<p>A dedicated repository for upgrade proposals exists at:</p>
<p><a href="https://github.com/0LNetworkCommunity/upgrades/" target="_blank" rel="noopener noreferrer">https://github.com/0LNetworkCommunity/upgrades/</a></p>
<p>The proposer can add the files folder and documentation link to this GitHub repo, for example:
<a href="https://github.com/0LNetworkCommunity/upgrades/tree/main/proposals/up-0005" target="_blank" rel="noopener noreferrer">https://github.com/0LNetworkCommunity/upgrades/tree/main/proposals/up-0005</a></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="pro-tip">PRO-TIP:<a href="#pro-tip" class="hash-link" aria-label="Direct link to PRO-TIP:" title="Direct link to PRO-TIP:">​</a></h4>
<p>If you already have this upgrades repo locally, you should run the command in the previous step (build artifacts) with <code>--output-dir</code> pointed to <code>./upgrades/proposals/up-000x</code>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="upgrade-ceremony">Upgrade Ceremony<a href="#upgrade-ceremony" class="hash-link" aria-label="Direct link to Upgrade Ceremony" title="Direct link to Upgrade Ceremony">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="3-with-txs-anyone-no-authority-needed-can-submit-the-proposal-and-metadata">3. With <code>txs</code> anyone (no authority needed) can submit the proposal and metadata.<a href="#3-with-txs-anyone-no-authority-needed-can-submit-the-proposal-and-metadata" class="hash-link" aria-label="Direct link to 3-with-txs-anyone-no-authority-needed-can-submit-the-proposal-and-metadata" title="Direct link to 3-with-txs-anyone-no-authority-needed-can-submit-the-proposal-and-metadata">​</a></h4>
<p>You&#x27;ll need to provide the actual script compiled path, and an optional URL which contains documentation of the proposal (e.g., GitHub).</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># NOTE: multi-step upgrades (all modules) only need ONE proposal, and it should reference the first module, usually 1-move-stdlib</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">libra txs governance propose --proposal-script-dir </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">PROPOSAL_SCRIPT_DIR</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> --metadata-url </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">URL</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Example</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">libra txs governance propose </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--proposal-script-dir </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">path/to</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">/framework_upgrade/1-move-stdlib/ </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--metadata-url https://github.com/0LNetworkCommunity/upgrades/tree/main/proposals/up-00</span><span class="token operator file-descriptor important" style="color:#393A34">0</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">PROPOSAL_ID</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">.md</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If this transaction succeeds, it will produce a proposal id, which is a number. Now the proposal is open to voting.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="note-you-can-query-the-next-proposal-using-this-command">NOTE: You can query the next proposal using this command:<a href="#note-you-can-query-the-next-proposal-using-this-command" class="hash-link" aria-label="Direct link to NOTE: You can query the next proposal using this command:" title="Direct link to NOTE: You can query the next proposal using this command:">​</a></h4>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">libra query view --function-id 0x1::diem_governance::get_next_governance_proposal_id</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="4-with-libra-txs-anyone-with-governance-authority-the-epochs-validators-as-of-v7-can-submit-a-vote-in-favor-or-against-it-with---should-fail">4. With <code>libra txs</code> anyone with governance authority (the epoch&#x27;s validators as of <code>V7</code>), can submit a vote in favor (or against it with <code>--should-fail</code>).<a href="#4-with-libra-txs-anyone-with-governance-authority-the-epochs-validators-as-of-v7-can-submit-a-vote-in-favor-or-against-it-with---should-fail" class="hash-link" aria-label="Direct link to 4-with-libra-txs-anyone-with-governance-authority-the-epochs-validators-as-of-v7-can-submit-a-vote-in-favor-or-against-it-with---should-fail" title="Direct link to 4-with-libra-txs-anyone-with-governance-authority-the-epochs-validators-as-of-v7-can-submit-a-vote-in-favor-or-against-it-with---should-fail">​</a></h4>
<p>We assume the default is to vote in favor. To vote &quot;approve&quot; simply:</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">libra txs governance vote --proposal-id </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">PROPOSAL_ID</span><span class="token operator" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If the voter would like the proposal to be rejected:</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">libra txs governance vote --proposal-id </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">PROPOSAL_ID</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> --should-fail</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>You can query to see the for and against votes using this command:</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">libra query view --function-id 0x1::diem_governance::get_votes </span><span class="token parameter variable" style="color:#36acaa">--args</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">proposal_number</span><span class="token operator" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div>
<p>After everyone has voted (to reach the consensus threshold of 66% as of <code>V7</code>), the proposal will be in a &quot;Resolvable&quot; state. Anyone can resolve it by submitting the upgrade transaction. This means the sender must have the source transaction script for the upgrade (step #1 above).</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="6-use-txs-to-resolve-a-successfully-approved-proposal">6. Use <code>txs</code> to resolve a successfully approved proposal<a href="#6-use-txs-to-resolve-a-successfully-approved-proposal" class="hash-link" aria-label="Direct link to 6-use-txs-to-resolve-a-successfully-approved-proposal" title="Direct link to 6-use-txs-to-resolve-a-successfully-approved-proposal">​</a></h4>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Note the actual path</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">libra txs governance resolve --proposal-script-dir </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">PROPOSAL_SCRIPT_DIR</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> --proposal-id </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">PROPOSAL_ID</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Example</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain">. libra txs governance resolve --proposal-script-dir ~/framework_upgrade/1-move-stdlib/ --proposal-id </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">2</span><span class="token plain">. libra txs governance resolve --proposal-script-dir ~/framework_upgrade/2-vendor-stdlib/ --proposal-id </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">3</span><span class="token plain">. libra txs governance resolve --proposal-script-dir ~/framework_upgrade/3-libra-framework/ --proposal-id </span><span class="token number" style="color:#36acaa">0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="if-this-transaction-is-successful-the-new-bytecode-will-be-written-to-the-vm--sidebar_position-9sidebar_label-hot-upgradesdescription-upgrading-framework-libraries">If this transaction is successful, the new bytecode will be written to the VM.--
sidebar_position: 9
sidebar_label: &#x27;Hot Upgrades&#x27;
description: &#x27;Upgrading Framework Libraries&#x27;<a href="#if-this-transaction-is-successful-the-new-bytecode-will-be-written-to-the-vm--sidebar_position-9sidebar_label-hot-upgradesdescription-upgrading-framework-libraries" class="hash-link" aria-label="Direct link to If this transaction is successful, the new bytecode will be written to the VM.--
sidebar_position: 9
sidebar_label: &#x27;Hot Upgrades&#x27;
description: &#x27;Upgrading Framework Libraries&#x27;" title="Direct link to If this transaction is successful, the new bytecode will be written to the VM.--
sidebar_position: 9
sidebar_label: &#x27;Hot Upgrades&#x27;
description: &#x27;Upgrading Framework Libraries&#x27;">​</a></h2>
<h1>Network Hot Upgrades</h1>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="overview-1">Overview<a href="#overview-1" class="hash-link" aria-label="Direct link to Overview" title="Direct link to Overview">​</a></h2>
<p>The &quot;framework&quot; which contains all the consensus, account, econ policies, etc. for the network is written in Move. This code is stored in the network database, and effectively executed on demand. This means that framework upgrades can occur without redeploying the Move VM itself, or the supporting system code (network node software). It also means the state machine can upgrade without a coordinated halt.</p>
<ul>
<li>
<p>To do this we require the <code>libra</code> cli tool. The command <code>libra move framework</code> is used for building the artifacts, and <code>libra txs</code> for proposing, voting, and ultimately deploying the artifacts.</p>
</li>
<li>
<p>Metadata with the upgrade artifacts and proposal documentation can be found at: <a href="https://github.com/0LNetworkCommunity/upgrades" target="_blank" rel="noopener noreferrer">https://github.com/0LNetworkCommunity/upgrades</a></p>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="historical-upgrade-information-and-proposing-upgrades-1">Historical Upgrade Information and Proposing Upgrades<a href="#historical-upgrade-information-and-proposing-upgrades-1" class="hash-link" aria-label="Direct link to Historical Upgrade Information and Proposing Upgrades" title="Direct link to Historical Upgrade Information and Proposing Upgrades">​</a></h2>
<p>Historical upgrade information since release 7.0.0 is canonically stored in the <a href="https://github.com/0LNetworkCommunity/upgrades" target="_blank" rel="noopener noreferrer">upgrade repository</a>. To submit an upgrade proposal, you should draft a PR with the relevant information detailing the upgrade using the provided <a href="https://github.com/0LNetworkCommunity/upgrades/tree/main/proposals/template" target="_blank" rel="noopener noreferrer">template</a> and include the upgrade script packages.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="tldr-1">TL;DR<a href="#tldr-1" class="hash-link" aria-label="Direct link to TL;DR" title="Direct link to TL;DR">​</a></h2>
<ul>
<li><strong>Fetch the latest release</strong>:</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd libra-framework</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git fetch --all</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git checkout release-x.x.x</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li><strong>Build framework</strong>:</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">libra move framework upgrade --output-dir &lt;path/to&gt;/framework_upgrade --framework-local-dir &lt;path/to&gt;/libra-framework/framework/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li><strong>Propose</strong>:</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">libra txs governance propose --proposal-script-dir &lt;path/to&gt;/framework_upgrade/1-move-stdlib/ --metadata-url https://github.com/0LNetworkCommunity/upgrades/tree/main/proposals/up-000&lt;PROPOSAL_ID&gt;.md</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># NOTE: Do not repeat this step. Multistep (multiple modules) only need one proposal, and it should reference the first module, usually 1-move-stdlib</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li><strong>Each Validator votes</strong>:</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">libra txs governance  vote --proposal-id &lt;ID&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li><strong>After vote, one person can resolve each module in order</strong>:</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">libra txs governance resolve --proposal-script-dir &lt;path/to&gt;/framework_upgrade/1-move-stdlib/ --proposal-id &lt;ID&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">libra txs governance resolve --proposal-script-dir &lt;path/to&gt;/framework_upgrade/2-vendor-stdlib/ --proposal-id &lt;ID&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">libra txs governance resolve --proposal-script-dir &lt;path/to&gt;/framework_upgrade/3-libra-framework/ --proposal-id &lt;ID&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="upgrade-types-single-and-multiple-1">Upgrade Types: Single and Multiple<a href="#upgrade-types-single-and-multiple-1" class="hash-link" aria-label="Direct link to Upgrade Types: Single and Multiple" title="Direct link to Upgrade Types: Single and Multiple">​</a></h2>
<p>When performing upgrades within the network framework, two primary approaches can be employed: single and multiple module upgrades. The key distinction lies in how these upgrades are proposed, voted on, and executed, particularly with respect to handling multiple modules.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="single-framework-upgrade-1">Single Framework Upgrade<a href="#single-framework-upgrade-1" class="hash-link" aria-label="Direct link to Single Framework Upgrade" title="Direct link to Single Framework Upgrade">​</a></h3>
<p>A single framework upgrade involves updating a singular set of modules within the framework. This process is straightforward and includes the following steps:</p>
<ul>
<li><strong>Build Framework</strong>: Generate the upgrade Move transaction scripts for the module.</li>
<li><strong>Proposal Submission</strong>: Propose the upgrade for the specific framework module.</li>
<li><strong>Validator Voting</strong>: Validators within the network vote for or against the proposed upgrade.</li>
<li><strong>Achieving Consensus</strong>: The proposal moves forward once it receives support from at least 66% of active validators.</li>
<li><strong>Resolution and Deployment</strong>: Resolve the proposal using the exact framework directory that matches the build of the proposed upgrade. This can be done by any validator using the same release branch from the <code>libra-framework</code> repository.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="multiple-framework-upgrades-1">Multiple Framework Upgrades<a href="#multiple-framework-upgrades-1" class="hash-link" aria-label="Direct link to Multiple Framework Upgrades" title="Direct link to Multiple Framework Upgrades">​</a></h3>
<p>Multiple framework upgrades require a more nuanced approach, especially regarding resolution stages, to ensure a coherent and secure update across several modules.</p>
<ul>
<li>
<p><strong>Build Framework</strong>: Similar to a single upgrade, start by generating Move transaction scripts for all relevant modules.</p>
</li>
<li>
<p><strong>Proposal for Initial Module</strong>: Propose the upgrade by using the first module (<code>1-move-stdlib</code>). This initial proposal is critical as it kickstarts the governance process for the entire upgrade.</p>
</li>
</ul>
<p><em>WARN: Do not repeat proposals for subsequent modules, the three modules can be upgraded with a single instance.</em></p>
<p>Importantly, the transaction script for upgrading this first module includes a significant addition: <strong>the transaction hash for the subsequent modules</strong> that needs upgrading. These hashes, produced during the artifact building phase, serve as secure identifiers for each module&#x27;s upgrade script. Do not run this step twice.</p>
<ul>
<li><strong>Validator Voting</strong>: As with single upgrades, validators vote for or against the proposed upgrade.</li>
<li><strong>Achieving Consensus and Sequential Resolution</strong>: Once at least 66% of active validators support the proposal, the initial upgrade can be resolved.</li>
<li><strong>Sequential Upgrade Execution</strong>: Execute the resolution process for all involved modules, following the order 1-3.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="upgrade-policy-1">Upgrade Policy<a href="#upgrade-policy-1" class="hash-link" aria-label="Direct link to Upgrade Policy" title="Direct link to Upgrade Policy">​</a></h2>
<p>The diem framework has information in the metadata that controls the policy that a publisher can set for upgrading their modules. These are:</p>
<ul>
<li>Arbitrary(0): Allows code upgrades without compatibility checks, for non-shared packages.</li>
<li>Compatible(1): Requires compatibility checks to ensure no breaking changes in public functions or resource layouts.</li>
<li>Immutable(2): Prevents any upgrades, ensuring the permanence of critical code.</li>
</ul>
<p>Due to some circumstances, a publisher may want to downgrade the policy to allow changes to go through that a restrictive policy would not allow. We can do this by building the framework with a flag(<code>--danger-force-upgrade</code>) that sets the upgrade policy as Arbitrary</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-1">Example<a href="#example-1" class="hash-link" aria-label="Direct link to Example" title="Direct link to Example">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">libra txs governance propose --proposal-script-dir &lt;path/to&gt;/framework_upgrade/3-libra-framework/ --metadata-url https://github.com/0LNetworkCommunity/upgrades/tree/main/proposals/up-000&lt;PROPOSAL_ID&gt; --danger-force-upgrade</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="procedure-1">Procedure<a href="#procedure-1" class="hash-link" aria-label="Direct link to Procedure" title="Direct link to Procedure">​</a></h2>
<p>We will use this guide to do a multi-step upgrade as this is the most common upgrade that is done.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="build-artifacts-1">Build Artifacts<a href="#build-artifacts-1" class="hash-link" aria-label="Direct link to Build Artifacts" title="Direct link to Build Artifacts">​</a></h3>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="1-build-the-upgrade-move-transaction-scripts-1">1. Build the upgrade Move transaction scripts<a href="#1-build-the-upgrade-move-transaction-scripts-1" class="hash-link" aria-label="Direct link to 1. Build the upgrade Move transaction scripts" title="Direct link to 1. Build the upgrade Move transaction scripts">​</a></h5>
<p>This will be a Move package which is machine-generated for a one-time execution. It contains bytecode which will be allowed to be executed (by anyone), once there is a vote and agreement on the proposal passing. The on-chain execution is guarded with a hash of this transaction, which the proposer provides in the proposal transaction (in advance of the vote).</p>
<p>An upgrade script that is tampered with will yield a different execution hash, and will be prevented from running (it is likely to be blocked by the transaction size limits before entering the mempool).</p>
<p>The <code>libra-framework upgrade</code> command will produce a newly compiled Move upgrade transaction script, its binary, and the hash.</p>
<p>You need to provide:</p>
<ul>
<li>
<p><code>--output-dir</code>: this directory the upgrade transaction files should be saved to. A new folder called <code>framework_upgrade</code> will be created under the output-dir path.</p>
</li>
<li>
<p><code>--framework-local-dir</code>: the source code for the framework so that the transaction script can import it as a dependency.</p>
</li>
</ul>
<p>Optionally you could provide the flag `--danger-force-upgrade</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="multi-or-single-upgrade-1">Multi or Single Upgrade<a href="#multi-or-single-upgrade-1" class="hash-link" aria-label="Direct link to Multi or Single Upgrade" title="Direct link to Multi or Single Upgrade">​</a></h4>
<p>Know the difference between a single step, and multi-step upgrades.
An upgrade that changes, all three (stdlib, vendor-stdlib, libra-framework) looks like this:
<a href="https://github.com/0LNetworkCommunity/upgrades/blob/main/proposals/up-0004/" target="_blank" rel="noopener noreferrer">https://github.com/0LNetworkCommunity/upgrades/blob/main/proposals/up-0004/</a></p>
<p>AN upgrade that changes only one module <code>libra-framework</code> can be seen here:
<a href="https://github.com/0LNetworkCommunity/upgrades/tree/main/proposals/up-0009" target="_blank" rel="noopener noreferrer">https://github.com/0LNetworkCommunity/upgrades/tree/main/proposals/up-0009</a></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="default-produce-all-three-module-upgrades-1">Default: Produce all three module upgrades<a href="#default-produce-all-three-module-upgrades-1" class="hash-link" aria-label="Direct link to Default: Produce all three module upgrades" title="Direct link to Default: Produce all three module upgrades">​</a></h3>
<p>Includes: stdlib, vendor-stdlib, libra-framework.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Note the paths</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">libra-framework upgrade \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--output-dir &lt;OUTPUT_DIR&gt; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--framework-local-dir &lt;FRAMEWORK_PATH&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Example</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">libra-framework upgrade \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--output-dir &lt;path/to&gt;/framework_upgrade \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--framework-local-dir &lt;path/to&gt;/libra-framework/framework/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="note-this-creates-3-separate-library-upgrade-script-directories-1">NOTE: This creates 3 separate library upgrade script directories<a href="#note-this-creates-3-separate-library-upgrade-script-directories-1" class="hash-link" aria-label="Direct link to NOTE: This creates 3 separate library upgrade script directories" title="Direct link to NOTE: This creates 3 separate library upgrade script directories">​</a></h4>
<ul>
<li>1-move-stdlib</li>
<li>2-vendor-stdlib</li>
<li>3-libra-framework</li>
</ul>
<p>All the artifacts are now created, the proposal transaction can be submitted. But it&#x27;s a good idea to document this on github first.</p>
<h1>Light: Only update one of the modules</h1>
<p>If the code is backwards compatible you can update a single module. This can be true for <code>libra-framework</code>, when there are no changes to <code>stdlib</code> or <code>vendor-stdlib</code>.</p>
<p>In that case you can include the argument <code>--core-modules libra-framework</code></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># example:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">libra-framework upgrade --core-modules libra-framework \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--output-dir &lt;path/to&gt;/framework_upgrade \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--framework-local-dir &lt;path/to&gt;/libra-framework/framework/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Note: --danger-force-upgrade can also be used here</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="2-share-the-output-artifacts-on-github-1">2. Share the output artifacts on Github.<a href="#2-share-the-output-artifacts-on-github-1" class="hash-link" aria-label="Direct link to 2. Share the output artifacts on Github." title="Direct link to 2. Share the output artifacts on Github.">​</a></h5>
<p>A dedicated repository for upgrade proposals exists at:</p>
<p><a href="https://github.com/0LNetworkCommunity/upgrades/" target="_blank" rel="noopener noreferrer">https://github.com/0LNetworkCommunity/upgrades/</a></p>
<p>The proposer can add the files folder and documentation  link to this Github repo, for example:
<a href="https://github.com/0LNetworkCommunity/upgrades/tree/main/proposals/up-0005" target="_blank" rel="noopener noreferrer">https://github.com/0LNetworkCommunity/upgrades/tree/main/proposals/up-0005</a></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="pro-tip-1">PRO-TIP:<a href="#pro-tip-1" class="hash-link" aria-label="Direct link to PRO-TIP:" title="Direct link to PRO-TIP:">​</a></h4>
<p>If you already have this upgrades repo locally, you should run the command in the previous step (build artifacts) with <code>--output-dir</code> pointed to <code>./upgrades/proposals/up-000x</code></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="upgrade-ceremony-1">Upgrade Ceremony<a href="#upgrade-ceremony-1" class="hash-link" aria-label="Direct link to Upgrade Ceremony" title="Direct link to Upgrade Ceremony">​</a></h3>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="3-with-txs-anyone-no-authority-needed-can-submit-the-proposal-and-metadata-1">3. With <code>txs</code> anyone (no authority needed) can submit the proposal and metadata.<a href="#3-with-txs-anyone-no-authority-needed-can-submit-the-proposal-and-metadata-1" class="hash-link" aria-label="Direct link to 3-with-txs-anyone-no-authority-needed-can-submit-the-proposal-and-metadata-1" title="Direct link to 3-with-txs-anyone-no-authority-needed-can-submit-the-proposal-and-metadata-1">​</a></h5>
<p>You&#x27;ll need to provide the actual script compiled path, and an optional URL which contains documentation of the proposal (e.g github).</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># NOTE: multi-step upgrades (all modules) only need ONE proposal, and it should reference the first module, usually 1-move-stdlib</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">libra txs governance propose --proposal-script-dir &lt;PROPOSAL_SCRIPT_DIR&gt; --metadata-url &lt;URL&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Example</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">libra txs governance propose \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--proposal-script-dir &lt;path/to&gt;/framework_upgrade/1-move-stdlib/ \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--metadata-url https://github.com/0LNetworkCommunity/upgrades/tree/main/proposals/up-000&lt;PROPOSAL_ID&gt;.md</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If this transaction succeeds it will produce a proposal id, which is a number. Now the proposal is open to voting.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="note-you-can-query-the-next-proposal-using-this-command-1">NOTE: You can query the next proposal using this command:<a href="#note-you-can-query-the-next-proposal-using-this-command-1" class="hash-link" aria-label="Direct link to NOTE: You can query the next proposal using this command:" title="Direct link to NOTE: You can query the next proposal using this command:">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">libra query view --function-id 0x1::diem_governance::get_next_governance_proposal_id</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>:::</p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="4-with-libra-txs-anyone-with-governance-authority-the-epochs-validators-as-of-v7-can-submit-a-vote-in-favor-or-against-it-with---should-fail-1">4. With <code>libra txs</code> anyone with governance authority (the epoch&#x27;s validators as of <code>V7</code>), can submit a vote in favor (or against it with <code>--should-fail</code>).<a href="#4-with-libra-txs-anyone-with-governance-authority-the-epochs-validators-as-of-v7-can-submit-a-vote-in-favor-or-against-it-with---should-fail-1" class="hash-link" aria-label="Direct link to 4-with-libra-txs-anyone-with-governance-authority-the-epochs-validators-as-of-v7-can-submit-a-vote-in-favor-or-against-it-with---should-fail-1" title="Direct link to 4-with-libra-txs-anyone-with-governance-authority-the-epochs-validators-as-of-v7-can-submit-a-vote-in-favor-or-against-it-with---should-fail-1">​</a></h5>
<p>We assume the default is to vote in favor. To vote &quot;approve&quot; simply:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">libra txs governance vote --proposal-id &lt;PROPOSAL_ID&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If voter would like the proposal to be rejected:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">libra txs governance vote --proposal-id &lt;PROPOSAL_ID&gt; --should-fail</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>You can query to see the for and against votes using this command:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">libra query view --function-id 0x1::diem_governance::get_votes --args &lt;proposal_number&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div>
<p>After everyone has voted (to reach the consensus threshold of 66% as of <code>V7</code>), the proposal will be in a &quot;Resolvable&quot; state. Anyone can resolve it by submitting the upgrade transaction. This means the sender must have the source transaction script for the upgrade (step #1 above).</p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="6-use-txs-to-resolve-a-successfully-approved-proposal-1">6. Use <code>txs</code> to resolve a successfully approved proposal<a href="#6-use-txs-to-resolve-a-successfully-approved-proposal-1" class="hash-link" aria-label="Direct link to 6-use-txs-to-resolve-a-successfully-approved-proposal-1" title="Direct link to 6-use-txs-to-resolve-a-successfully-approved-proposal-1">​</a></h5>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Note the actual path</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">libra txs governance resolve --proposal-script-dir &lt;PROPOSAL_SCRIPT_DIR&gt; --proposal-id &lt;PROPOSAL_ID&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Example</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    1. libra txs governance resolve --proposal-script-dir ~/framework_upgrade/1-move-stdlib/ --proposal-id 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    2. libra txs governance resolve --proposal-script-dir ~/framework_upgrade/2-vendor-stdlib/ --proposal-id 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    3. libra txs governance resolve --proposal-script-dir ~/framework_upgrade/3-libra-framework/ --proposal-id 0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If this transaction is successful the new bytecode will be written to the VM</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/0LNetworkCommunity/documentation/edit/main/docs/validators/hot-upgrades.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/validators/with-docker-setup"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Docker setup</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/category/yaml-templates"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">YAML Templates</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link toc-highlight">Overview</a></li><li><a href="#historical-upgrade-information-and-proposing-upgrades" class="table-of-contents__link toc-highlight">Historical Upgrade Information and Proposing Upgrades</a></li><li><a href="#tldr" class="table-of-contents__link toc-highlight">TL;DR</a></li><li><a href="#upgrade-types-single-and-multiple" class="table-of-contents__link toc-highlight">Upgrade Types: Single and Multiple</a><ul><li><a href="#single-framework-upgrade" class="table-of-contents__link toc-highlight">Single Framework Upgrade</a></li><li><a href="#multiple-framework-upgrades" class="table-of-contents__link toc-highlight">Multiple Framework Upgrades</a></li></ul></li><li><a href="#upgrade-policy" class="table-of-contents__link toc-highlight">Upgrade Policy</a></li><li><a href="#procedure" class="table-of-contents__link toc-highlight">Procedure</a><ul><li><a href="#build-artifacts" class="table-of-contents__link toc-highlight">Build Artifacts</a></li><li><a href="#default-produce-all-three-module-upgrades" class="table-of-contents__link toc-highlight">Default: Produce all three module upgrades</a></li><li><a href="#light-only-update-one-of-the-modules" class="table-of-contents__link toc-highlight">Light: Only update one of the modules</a></li><li><a href="#upgrade-ceremony" class="table-of-contents__link toc-highlight">Upgrade Ceremony</a></li></ul></li><li><a href="#if-this-transaction-is-successful-the-new-bytecode-will-be-written-to-the-vm--sidebar_position-9sidebar_label-hot-upgradesdescription-upgrading-framework-libraries" class="table-of-contents__link toc-highlight">If this transaction is successful, the new bytecode will be written to the VM.--
sidebar_position: 9
sidebar_label: &#39;Hot Upgrades&#39;
description: &#39;Upgrading Framework Libraries&#39;</a></li><li><a href="#overview-1" class="table-of-contents__link toc-highlight">Overview</a></li><li><a href="#historical-upgrade-information-and-proposing-upgrades-1" class="table-of-contents__link toc-highlight">Historical Upgrade Information and Proposing Upgrades</a></li><li><a href="#tldr-1" class="table-of-contents__link toc-highlight">TL;DR</a></li><li><a href="#upgrade-types-single-and-multiple-1" class="table-of-contents__link toc-highlight">Upgrade Types: Single and Multiple</a><ul><li><a href="#single-framework-upgrade-1" class="table-of-contents__link toc-highlight">Single Framework Upgrade</a></li><li><a href="#multiple-framework-upgrades-1" class="table-of-contents__link toc-highlight">Multiple Framework Upgrades</a></li></ul></li><li><a href="#upgrade-policy-1" class="table-of-contents__link toc-highlight">Upgrade Policy</a></li><li><a href="#procedure-1" class="table-of-contents__link toc-highlight">Procedure</a><ul><li><a href="#build-artifacts-1" class="table-of-contents__link toc-highlight">Build Artifacts</a></li><li><a href="#default-produce-all-three-module-upgrades-1" class="table-of-contents__link toc-highlight">Default: Produce all three module upgrades</a></li><li><a href="#upgrade-ceremony-1" class="table-of-contents__link toc-highlight">Upgrade Ceremony</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title"></div><ul class="footer__items clean-list"><li class="footer__item">
                <div class="footer-left">
                  <a class="footer-logo" href="https://openlibra.io/" target="_blank" rel="noopener noreferrer" title="Open Libra">
                  <img src="/img/logo.png" alt="0L Network logo">
                  </a>
                </div>
                </li></ul></div><div class="col footer__col"><div class="footer__title"></div><ul class="footer__items clean-list"><li class="footer__item">
                  <p class="right">
                    <nav class="social-links">
                        <a class="social-link" href="https://github.com/0LNetworkCommunity/" target="_blank" rel="noopener noreferrer" title="Github">
                         <svg width="100%" height="100%" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M10 0C4.47514 0 0 4.47514 0 10C0 14.4199 2.86679 18.1645 6.83855 19.4905C7.33579 19.5826 7.51995 19.2756 7.51995 19.0055C7.51995 18.7661 7.51381 18.14 7.50767 17.3051C4.72683 17.9067 4.13751 15.9668 4.13751 15.9668C3.68324 14.8128 3.0264 14.5058 3.0264 14.5058C2.11786 13.8858 3.09392 13.8981 3.09392 13.8981C4.09454 13.9718 4.62861 14.9294 4.62861 14.9294C5.51872 16.4579 6.96746 16.016 7.53837 15.7581C7.63045 15.1136 7.88827 14.6716 8.17066 14.4199C5.94843 14.1682 3.61571 13.3088 3.61571 9.47821C3.61571 8.38551 4.00246 7.4954 4.64702 6.79558C4.54266 6.54389 4.19889 5.52486 4.74524 4.14978C4.74524 4.14978 5.58625 3.87968 7.4954 5.17495C8.29343 4.95396 9.14672 4.84346 10 4.83732C10.8471 4.83732 11.7066 4.95396 12.5046 5.17495C14.4137 3.87968 15.2548 4.14978 15.2548 4.14978C15.8011 5.52486 15.4573 6.54389 15.353 6.79558C15.9914 7.4954 16.3781 8.38551 16.3781 9.47821C16.3781 13.3211 14.0393 14.1621 11.8109 14.4137C12.167 14.7207 12.4923 15.3346 12.4923 16.2676C12.4923 17.6059 12.48 18.6802 12.48 19.0117C12.48 19.2818 12.6581 19.5887 13.1676 19.4905C17.1393 18.1645 20 14.4199 20 10.0061C20 4.47514 15.5249 0 10 0Z" fill="currentColor"/></svg>
                        </a>
                        <a class="social-link" href="https://discord.gg/0lnetwork" target="_blank" rel="noopener noreferrer" title="Discord">
                          <svg width="100%" height="100%" viewBox="0 0 71 55" fill="none" xmlns="http://www.w3.org/2000/svg"><g clip-path="url(#a)"><path d="M60.105 4.898A58.55 58.55 0 0 0 45.653.415a.22.22 0 0 0-.233.11 40.784 40.784 0 0 0-1.8 3.697c-5.456-.817-10.886-.817-16.23 0-.485-1.164-1.201-2.587-1.828-3.697a.228.228 0 0 0-.233-.11 58.386 58.386 0 0 0-14.451 4.483.207.207 0 0 0-.095.082C1.578 18.73-.944 32.144.293 45.39a.244.244 0 0 0 .093.167c6.073 4.46 11.955 7.167 17.729 8.962a.23.23 0 0 0 .249-.082 42.08 42.08 0 0 0 3.627-5.9.225.225 0 0 0-.123-.312 38.772 38.772 0 0 1-5.539-2.64.228.228 0 0 1-.022-.378 31.17 31.17 0 0 0 1.1-.862.22.22 0 0 1 .23-.03c11.619 5.304 24.198 5.304 35.68 0a.219.219 0 0 1 .233.027c.356.293.728.586 1.103.865a.228.228 0 0 1-.02.378 36.384 36.384 0 0 1-5.54 2.637.227.227 0 0 0-.121.315 47.249 47.249 0 0 0 3.624 5.897.225.225 0 0 0 .249.084c5.801-1.794 11.684-4.502 17.757-8.961a.228.228 0 0 0 .092-.164c1.48-15.315-2.48-28.618-10.497-40.412a.18.18 0 0 0-.093-.084Zm-36.38 32.427c-3.497 0-6.38-3.211-6.38-7.156 0-3.944 2.827-7.156 6.38-7.156 3.583 0 6.438 3.24 6.382 7.156 0 3.945-2.827 7.156-6.381 7.156Zm23.593 0c-3.498 0-6.38-3.211-6.38-7.156 0-3.944 2.826-7.156 6.38-7.156 3.582 0 6.437 3.24 6.38 7.156 0 3.945-2.798 7.156-6.38 7.156Z" fill="currentColor"/></g><defs><clipPath id="a"><path fill="currentColor" d="M0 0h71v55H0z"/></clipPath></defs></svg>
                        </a>
                    </nav>
                  </p>
              </li></ul></div></div></div></footer></div>
</body>
</html>